<!DOCTYPE html>
<html lang="zh">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Three.js 交互式变换应用</title>
    <!-- Chosen Palette: Calm Harmony (Warm Neutrals & Subtle Earth Tones) -->
    <!-- Application Structure Plan: A two-part SPA. Part 1 is an interactive sandbox with controls (sliders) on the left and a live Three.js canvas on the right, allowing users to explore position/scale changes in real-time. A dynamic code snippet shows the corresponding code. Part 2 consists of informational cards summarizing the key concepts (definitions, methods) from the source report. This structure prioritizes hands-on exploration over static data presentation, which is most effective for learning a programming concept. -->
    <!-- Visualization & Content Choices: The primary visualization is a live, interactive Three.js scene (Goal: Explore, Interact). This is superior to a static chart as it directly demonstrates the 3D spatial concepts. It's supplemented by a dynamic code block (Goal: Inform), linking UI actions to code. Key concepts are organized into HTML/CSS cards (Goal: Organize) for easy reference. This avoids inappropriate use of charting libraries like Chart.js for non-data-driven content. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script type="importmap">
      {
        "imports": {
          "three": "https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.module.js",
          "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.160.0/examples/jsm/"
        }
      }
    </script>
    <style>
      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          "Helvetica Neue", Arial, sans-serif;
        background-color: #f5f5f5;
        color: #424242;
      }
      .control-panel {
        background-color: #efebe9;
      }
      .slider::-webkit-slider-thumb {
        -webkit-appearance: none;
        appearance: none;
        width: 20px;
        height: 20px;
        background: #795548;
        cursor: pointer;
        border-radius: 50%;
      }
      .slider::-moz-range-thumb {
        width: 20px;
        height: 20px;
        background: #795548;
        cursor: pointer;
        border-radius: 50%;
      }
      .info-card {
        background-color: #ffffff;
      }
      .code-block {
        background-color: #3e2723;
        color: #f5f5f5;
      }
      .btn {
        background-color: #795548;
        color: white;
      }
      .btn:hover {
        background-color: #5d4037;
      }
    </style>
  </head>
  <body class="antialiased">
    <div class="container mx-auto p-4 md:p-8">
      <main class="bg-white shadow-xl rounded-lg overflow-hidden">
        <div class="grid grid-cols-1 lg:grid-cols-3">
          <div class="lg:col-span-1 p-6 control-panel">
            <div class="mb-6">
              <h3 class="text-lg font-semibold mb-3 text-gray-600">
                位置 (Position)
              </h3>
              <div class="space-y-3">
                <div>
                  <label for="posX" class="flex justify-between text-sm"
                    ><span>Position X</span><span id="posX-val">0</span></label
                  >
                  <input
                    type="range"
                    id="posX"
                    min="-5"
                    max="5"
                    value="0"
                    step="0.1"
                    class="w-full h-2 bg-gray-300 rounded-lg appearance-none cursor-pointer slider"
                  />
                </div>
                <div>
                  <label for="posY" class="flex justify-between text-sm"
                    ><span>Position Y</span><span id="posY-val">0</span></label
                  >
                  <input
                    type="range"
                    id="posY"
                    min="-5"
                    max="5"
                    value="0"
                    step="0.1"
                    class="w-full h-2 bg-gray-300 rounded-lg appearance-none cursor-pointer slider"
                  />
                </div>
                <div>
                  <label for="posZ" class="flex justify-between text-sm"
                    ><span>Position Z</span><span id="posZ-val">0</span></label
                  >
                  <input
                    type="range"
                    id="posZ"
                    min="-5"
                    max="5"
                    value="0"
                    step="0.1"
                    class="w-full h-2 bg-gray-300 rounded-lg appearance-none cursor-pointer slider"
                  />
                </div>
              </div>
            </div>

            <div class="mb-6">
              <h3 class="text-lg font-semibold mb-3 text-gray-600">
                缩放 (Scale)
              </h3>
              <div class="space-y-3">
                <div>
                  <label for="scaleX" class="flex justify-between text-sm"
                    ><span>Scale X</span><span id="scaleX-val">1</span></label
                  >
                  <input
                    type="range"
                    id="scaleX"
                    min="0.1"
                    max="3"
                    value="1"
                    step="0.1"
                    class="w-full h-2 bg-gray-300 rounded-lg appearance-none cursor-pointer slider"
                  />
                </div>
                <div>
                  <label for="scaleY" class="flex justify-between text-sm"
                    ><span>Scale Y</span><span id="scaleY-val">1</span></label
                  >
                  <input
                    type="range"
                    id="scaleY"
                    min="0.1"
                    max="3"
                    value="1"
                    step="0.1"
                    class="w-full h-2 bg-gray-300 rounded-lg appearance-none cursor-pointer slider"
                  />
                </div>
                <div>
                  <label for="scaleZ" class="flex justify-between text-sm"
                    ><span>Scale Z</span><span id="scaleZ-val">1</span></label
                  >
                  <input
                    type="range"
                    id="scaleZ"
                    min="0.1"
                    max="3"
                    value="1"
                    step="0.1"
                    class="w-full h-2 bg-gray-300 rounded-lg appearance-none cursor-pointer slider"
                  />
                </div>
              </div>
            </div>

            <div class="mb-6">
              <h3 class="text-lg font-semibold mb-2 text-gray-600">对应代码</h3>
              <div
                class="code-block p-4 rounded-md font-mono text-sm overflow-x-auto"
              >
                <pre><code id="code-snippet">object.position.set(0, 0, 0);
object.scale.set(1, 1, 1);</code></pre>
              </div>
            </div>

            <button
              id="reset-btn"
              class="w-full py-2 rounded-md font-bold transition-transform transform hover:scale-105 btn"
            >
              <span>🔄</span> 重置变换
            </button>
          </div>

          <div class="lg:col-span-2 h-96 lg:h-auto min-h-[400px]">
            <canvas id="three-canvas" class="w-full h-full block"></canvas>
          </div>
        </div>
      </main>

      <section class="mt-12">
        <h2 class="text-3xl font-bold text-center mb-8 text-gray-800">
          核心概念回顾
        </h2>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
          <div class="info-card p-6 rounded-lg shadow-lg">
            <h3 class="text-2xl font-bold mb-3 text-gray-700">
              Position: Vector3
            </h3>
            <p class="mb-4 text-gray-600">
              定义物体局部坐标，决定其在父对象坐标系中的位置。默认值为 `(0, 0,
              0)`。
            </p>
            <ul class="list-disc list-inside space-y-2 text-gray-700">
              <li><strong>.x, .y, .z</strong>: 直接读写各轴分量。</li>
              <li><strong>.set(x, y, z)</strong>: 一次性设置三个分量。</li>
              <li><strong>.copy(v)</strong>: 从另一个向量复制值。</li>
            </ul>
          </div>
          <div class="info-card p-6 rounded-lg shadow-lg">
            <h3 class="text-2xl font-bold mb-3 text-gray-700">
              Scale: Vector3
            </h3>
            <p class="mb-4 text-gray-600">
              定义物体在各轴向的局部缩放比例。默认值为 `(1, 1,
              1)`，代表原始大小。
            </p>
            <ul class="list-disc list-inside space-y-2 text-gray-700">
              <li><strong>.x, .y, .z</strong>: 直接读写各轴缩放比例。</li>
              <li><strong>.set(x, y, z)</strong>: 设置非均匀缩放。</li>
              <li>
                <strong>.setScalar(s)</strong>:
                设置所有轴为相同值，实现均匀缩放。
              </li>
            </ul>
          </div>
        </div>
      </section>
    </div>

    <script type="module">
      import * as THREE from "three";
      import { OrbitControls } from "three/addons/controls/OrbitControls.js";

      let scene, camera, renderer, controls, interactiveCube;

      const sliders = {
        posX: document.getElementById("posX"),
        posY: document.getElementById("posY"),
        posZ: document.getElementById("posZ"),
        scaleX: document.getElementById("scaleX"),
        scaleY: document.getElementById("scaleY"),
        scaleZ: document.getElementById("scaleZ"),
      };

      const values = {
        "posX-val": document.getElementById("posX-val"),
        "posY-val": document.getElementById("posY-val"),
        "posZ-val": document.getElementById("posZ-val"),
        "scaleX-val": document.getElementById("scaleX-val"),
        "scaleY-val": document.getElementById("scaleY-val"),
        "scaleZ-val": document.getElementById("scaleZ-val"),
      };

      const codeSnippet = document.getElementById("code-snippet");
      const resetButton = document.getElementById("reset-btn");

      function init() {
        const canvas = document.getElementById("three-canvas");
        const container = canvas.parentElement;

        scene = new THREE.Scene();
        scene.background = new THREE.Color(0xd7ccc8);

        camera = new THREE.PerspectiveCamera(
          50,
          container.clientWidth / container.clientHeight,
          0.1,
          1000
        );
        camera.position.set(5, 6, 10);

        renderer = new THREE.WebGLRenderer({ canvas: canvas, antialias: true });
        renderer.setSize(container.clientWidth, container.clientHeight);
        renderer.setPixelRatio(window.devicePixelRatio);

        const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);
        scene.add(ambientLight);
        const directionalLight = new THREE.DirectionalLight(0xffffff, 1.0);
        directionalLight.position.set(5, 10, 7.5);
        scene.add(directionalLight);

        const gridHelper = new THREE.GridHelper(10, 10);
        scene.add(gridHelper);
        const axesHelper = new THREE.AxesHelper(2);
        scene.add(axesHelper);

        const geometry = new THREE.BoxGeometry(1.5, 1.5, 1.5);

        const referenceMaterial = new THREE.MeshStandardMaterial({
          color: 0x757575,
          wireframe: true,
          opacity: 0.3,
          transparent: true,
        });
        const referenceCube = new THREE.Mesh(geometry, referenceMaterial);
        scene.add(referenceCube);

        const interactiveMaterial = new THREE.MeshStandardMaterial({
          color: 0x795548,
          metalness: 0.3,
          roughness: 0.6,
        });
        interactiveCube = new THREE.Mesh(geometry, interactiveMaterial);
        scene.add(interactiveCube);

        controls = new OrbitControls(camera, renderer.domElement);
        controls.enableDamping = true;

        window.addEventListener("resize", onWindowResize);
        for (const key in sliders) {
          sliders[key].addEventListener("input", updateTransform);
        }
        resetButton.addEventListener("click", resetTransform);

        updateTransform();
        animate();
      }

      function updateTransform() {
        const pX = parseFloat(sliders.posX.value);
        const pY = parseFloat(sliders.posY.value);
        const pZ = parseFloat(sliders.posZ.value);
        interactiveCube.position.set(pX, pY, pZ);

        const sX = parseFloat(sliders.scaleX.value);
        const sY = parseFloat(sliders.scaleY.value);
        const sZ = parseFloat(sliders.scaleZ.value);
        interactiveCube.scale.set(sX, sY, sZ);

        values["posX-val"].textContent = pX.toFixed(1);
        values["posY-val"].textContent = pY.toFixed(1);
        values["posZ-val"].textContent = pZ.toFixed(1);
        values["scaleX-val"].textContent = sX.toFixed(1);
        values["scaleY-val"].textContent = sY.toFixed(1);
        values["scaleZ-val"].textContent = sZ.toFixed(1);

        updateCodeSnippet(pX, pY, pZ, sX, sY, sZ);
      }

      function updateCodeSnippet(pX, pY, pZ, sX, sY, sZ) {
        codeSnippet.innerHTML = `object.position.set(${pX.toFixed(
          1
        )}, ${pY.toFixed(1)}, ${pZ.toFixed(1)});
object.scale.set(${sX.toFixed(1)}, ${sY.toFixed(1)}, ${sZ.toFixed(1)});`;
      }

      function resetTransform() {
        sliders.posX.value = 0;
        sliders.posY.value = 0;
        sliders.posZ.value = 0;
        sliders.scaleX.value = 1;
        sliders.scaleY.value = 1;
        sliders.scaleZ.value = 1;
        updateTransform();
      }

      function onWindowResize() {
        const container = renderer.domElement.parentElement;
        camera.aspect = container.clientWidth / container.clientHeight;
        camera.updateProjectionMatrix();
        renderer.setSize(container.clientWidth, container.clientHeight);
      }

      function animate() {
        requestAnimationFrame(animate);
        controls.update();
        renderer.render(scene, camera);
      }

      init();
    </script>
  </body>
</html>
