<!DOCTYPE html>
<html lang="zh">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Three.js Group 示例</title>
    <style>
      body {
        margin: 0;
        overflow: hidden;
      }
      canvas {
        display: block;
      }
    </style>
  </head>
  <body>
    <script type="importmap">
      {
        "imports": {
          "three": "https://unpkg.com/three@0.160.0/build/three.module.js"
        }
      }
    </script>
    <script type="module">
      import * as THREE from "three";

      // 1. 初始化场景、相机和渲染器
      const scene = new THREE.Scene();
      scene.background = new THREE.Color(0x111111); // 设置深色背景

      const camera = new THREE.PerspectiveCamera(
        75,
        window.innerWidth / window.innerHeight,
        0.1,
        1000
      );
      camera.position.z = 10;

      const renderer = new THREE.WebGLRenderer({ antialias: true });
      renderer.setSize(window.innerWidth, window.innerHeight);
      document.body.appendChild(renderer.domElement);

      // 添加坐标轴辅助线，方便观察
      const axesHelper = new THREE.AxesHelper(5);
      scene.add(axesHelper);

      // 2. 创建一个分组
      const group = new THREE.Group();

      // 3. 创建两个不同的物体（Mesh）
      // 创建中心的大立方体
      const mainCubeGeometry = new THREE.BoxGeometry(2, 2, 2);
      const mainCubeMaterial = new THREE.MeshBasicMaterial({
        color: 0x00ff00,
        wireframe: true,
      });
      const mainCube = new THREE.Mesh(mainCubeGeometry, mainCubeMaterial);

      // 创建环绕的小立方体
      const smallCubeGeometry = new THREE.BoxGeometry(0.8, 0.8, 0.8);
      const smallCubeMaterial = new THREE.MeshBasicMaterial({
        color: 0xff00ff,
      });
      const smallCube = new THREE.Mesh(smallCubeGeometry, smallCubeMaterial);
      // 设置小立方体相对于分组原点的位置
      smallCube.position.x = 3;

      // 4. 将创建的物体添加到分组中
      group.add(mainCube);
      group.add(smallCube);

      // 5. 将整个分组添加到场景中
      scene.add(group);

      // 动画循环
      function animate() {
        requestAnimationFrame(animate);

        // 旋转整个分组
        // 可以看到两个立方体都围绕着分组的原点（世界坐标的0,0,0）进行旋转
        group.rotation.y += 0.01;
        group.rotation.x += 0.005;

        renderer.render(scene, camera);
      }

      // 监听窗口大小变化
      window.addEventListener("resize", () => {
        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();
        renderer.setSize(window.innerWidth, window.innerHeight);
      });

      animate();
    </script>
  </body>
</html>
